module.exports = [
"[externals]/next/dist/compiled/next-server/app-route-turbo.runtime.dev.js [external] (next/dist/compiled/next-server/app-route-turbo.runtime.dev.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/compiled/next-server/app-route-turbo.runtime.dev.js", () => require("next/dist/compiled/next-server/app-route-turbo.runtime.dev.js"));

module.exports = mod;
}),
"[externals]/next/dist/compiled/@opentelemetry/api [external] (next/dist/compiled/@opentelemetry/api, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/compiled/@opentelemetry/api", () => require("next/dist/compiled/@opentelemetry/api"));

module.exports = mod;
}),
"[externals]/next/dist/compiled/next-server/app-page-turbo.runtime.dev.js [external] (next/dist/compiled/next-server/app-page-turbo.runtime.dev.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/compiled/next-server/app-page-turbo.runtime.dev.js", () => require("next/dist/compiled/next-server/app-page-turbo.runtime.dev.js"));

module.exports = mod;
}),
"[externals]/next/dist/server/app-render/work-unit-async-storage.external.js [external] (next/dist/server/app-render/work-unit-async-storage.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/server/app-render/work-unit-async-storage.external.js", () => require("next/dist/server/app-render/work-unit-async-storage.external.js"));

module.exports = mod;
}),
"[externals]/next/dist/server/app-render/work-async-storage.external.js [external] (next/dist/server/app-render/work-async-storage.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/server/app-render/work-async-storage.external.js", () => require("next/dist/server/app-render/work-async-storage.external.js"));

module.exports = mod;
}),
"[externals]/next/dist/shared/lib/no-fallback-error.external.js [external] (next/dist/shared/lib/no-fallback-error.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/shared/lib/no-fallback-error.external.js", () => require("next/dist/shared/lib/no-fallback-error.external.js"));

module.exports = mod;
}),
"[externals]/next/dist/server/app-render/after-task-async-storage.external.js [external] (next/dist/server/app-render/after-task-async-storage.external.js, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("next/dist/server/app-render/after-task-async-storage.external.js", () => require("next/dist/server/app-render/after-task-async-storage.external.js"));

module.exports = mod;
}),
"[externals]/child_process [external] (child_process, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("child_process", () => require("child_process"));

module.exports = mod;
}),
"[externals]/fs [external] (fs, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("fs", () => require("fs"));

module.exports = mod;
}),
"[externals]/https [external] (https, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("https", () => require("https"));

module.exports = mod;
}),
"[externals]/stream [external] (stream, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("stream", () => require("stream"));

module.exports = mod;
}),
"[externals]/os [external] (os, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("os", () => require("os"));

module.exports = mod;
}),
"[externals]/events [external] (events, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("events", () => require("events"));

module.exports = mod;
}),
"[externals]/process [external] (process, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("process", () => require("process"));

module.exports = mod;
}),
"[externals]/util [external] (util, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("util", () => require("util"));

module.exports = mod;
}),
"[externals]/path [external] (path, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("path", () => require("path"));

module.exports = mod;
}),
"[externals]/crypto [external] (crypto, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("crypto", () => require("crypto"));

module.exports = mod;
}),
"[externals]/querystring [external] (querystring, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("querystring", () => require("querystring"));

module.exports = mod;
}),
"[externals]/buffer [external] (buffer, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("buffer", () => require("buffer"));

module.exports = mod;
}),
"[externals]/fs/promises [external] (fs/promises, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("fs/promises", () => require("fs/promises"));

module.exports = mod;
}),
"[externals]/node:stream [external] (node:stream, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:stream", () => require("node:stream"));

module.exports = mod;
}),
"[externals]/node:stream/promises [external] (node:stream/promises, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("node:stream/promises", () => require("node:stream/promises"));

module.exports = mod;
}),
"[externals]/http [external] (http, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("http", () => require("http"));

module.exports = mod;
}),
"[externals]/net [external] (net, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("net", () => require("net"));

module.exports = mod;
}),
"[externals]/tls [external] (tls, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("tls", () => require("tls"));

module.exports = mod;
}),
"[externals]/url [external] (url, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("url", () => require("url"));

module.exports = mod;
}),
"[externals]/zlib [external] (zlib, cjs)", ((__turbopack_context__, module, exports) => {

const mod = __turbopack_context__.x("zlib", () => require("zlib"));

module.exports = mod;
}),
"[project]/Desktop/2025/EstateIQIndia/app/api/state-analysis/route.ts [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "POST",
    ()=>POST
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$Desktop$2f$2025$2f$EstateIQIndia$2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/Desktop/2025/EstateIQIndia/node_modules/next/server.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$Desktop$2f$2025$2f$EstateIQIndia$2f$node_modules$2f40$google$2f$genai$2f$dist$2f$node$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/Desktop/2025/EstateIQIndia/node_modules/@google/genai/dist/node/index.mjs [app-route] (ecmascript)");
;
;
async function POST(request) {
    try {
        const { stateName } = await request.json();
        const apiKey = process.env.GEMINI_API_KEY || '';
        console.log('üìç State analysis requested for:', stateName);
        console.log('üîë API Key Status:', apiKey ? `Loaded (length: ${apiKey.length})` : '‚ùå EMPTY');
        if (!apiKey) {
            return __TURBOPACK__imported__module__$5b$project$5d2f$Desktop$2f$2025$2f$EstateIQIndia$2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
                error: 'API Key missing'
            }, {
                status: 500
            });
        }
        if (!stateName) {
            return __TURBOPACK__imported__module__$5b$project$5d2f$Desktop$2f$2025$2f$EstateIQIndia$2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
                error: 'State name is required'
            }, {
                status: 400
            });
        }
        // Initialize GoogleGenAI inside the function
        const ai = new __TURBOPACK__imported__module__$5b$project$5d2f$Desktop$2f$2025$2f$EstateIQIndia$2f$node_modules$2f40$google$2f$genai$2f$dist$2f$node$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["GoogleGenAI"]({
            apiKey
        });
        // Calculate current date and 6 months ago dynamically
        const currentDate = new Date();
        const sixMonthsAgo = new Date();
        sixMonthsAgo.setMonth(currentDate.getMonth() - 6);
        // Format dates for the prompt
        const currentDateStr = currentDate.toLocaleDateString('en-US', {
            month: 'long',
            year: 'numeric'
        });
        const sixMonthsAgoStr = sixMonthsAgo.toLocaleDateString('en-US', {
            month: 'long',
            year: 'numeric'
        });
        const currentYear = currentDate.getFullYear();
        const prompt = `You are an expert India real estate investment advisor. Analyze the investment potential for ${stateName} state.

IMPORTANT - TODAY'S DATE: ${currentDateStr}
Current Year: ${currentYear}

IMPORTANT: Use PLAIN TEXT ONLY. Do NOT use markdown formatting symbols like **, *, #, or other markup. Write clean, readable text without any formatting characters.

**USE GOOGLE SEARCH** for the latest data on:
- Property price trends and YoY appreciation rates (${currentYear} - CURRENT YEAR DATA ONLY)
- Recent infrastructure project announcements
- IT parks, SEZ, and business hub developments
- RERA compliance status and state regulations
- Stamp duty rates and circle rates
- Government housing schemes (PMAY, Smart Cities, AMRUT)
- Fastest growing cities by price appreciation
- Latest real estate news and market developments (from ${sixMonthsAgoStr} to ${currentDateStr} ONLY)
- Political factors affecting real estate (policies, regulations, government initiatives)
- Economic indicators (GDP growth, employment rates, major industries)

**USE GOOGLE MAPS** to identify:
- Metro/railway connectivity for major cities
- Proximity to IT hubs, airports, business districts
- Upcoming metro lines and infrastructure corridors

**Analysis Requirements:**

1. **Executive Summary:** Provide a comprehensive overview covering:
   - Overview: 2-3 sentences about the overall real estate landscape
   - Political Factors: Government policies, regulatory changes, upcoming elections impact, housing schemes
   - Economic Factors: State GDP growth, employment trends, major industries, investment climate
   - Market Outlook: Future projections, emerging opportunities, risk factors

2. **Latest Real Estate News (5-7 recent articles):** Search for latest news about ${stateName} real estate from ${sixMonthsAgoStr} to ${currentDateStr}:
   - MUST be published between ${sixMonthsAgoStr} and ${currentDateStr} (NO older articles from previous years)
   - Headline
   - Date (format: "DD MMM YYYY")
   - Summary (1-2 sentences)
   - Source name

3. **Investment Score (1-100):** Based on infrastructure, economic growth, property appreciation, rental yields, and regulatory environment.

4. **Market Summary:** 2-3 sentences covering current market conditions, recent price trends, and growth drivers.

5. **Top Cities (3-5):** Select cities with best overall investment potential. For EACH city provide:
   - Name
   - Tier classification (Tier 1/2/3) with justification
   - Growth potential (High/Moderate/Stable) based on upcoming projects
   - Average price per sq.ft (‚Çπ) - mention area type (e.g., "‚Çπ5,500 in prime localities")
   - Description: Why invest? Include proximity to IT hubs, metro stations, rental yield potential, infrastructure access

6. **Fastest Growing Cities (Top 3):** Cities with highest price appreciation in ${stateName}:
   - City name
   - YoY growth rate (%) for ${currentYear - 1}-${currentYear} (USE CURRENT YEAR DATA)
   - Reason for rapid growth (new metro, IT park, airport expansion, smart city status, etc.)

7. **Market Trends (3-5 key trends):**
   - Overall state price appreciation % (YoY ${currentYear - 1}-${currentYear} - CURRENT YEAR ONLY)
   - Emerging micro-markets and localities
   - Demand shifts (residential vs commercial)
   - Impact of new infrastructure projects
   - Rental yield trends and investment preferences

8. **Infrastructure Projects (3-5 major projects):**
   - Include project name, timeline/completion year, and investment impact
   - Focus on: metro lines, expressways, airports, IT parks, smart city initiatives, industrial corridors

**CRITICAL:**
1. Return ONLY a valid JSON object. No explanatory text before or after.
2. All text in descriptions, trends, and reasons must be PLAIN TEXT without markdown symbols (**, *, #, etc.)
3. For growth rates, use LATEST ${currentYear - 1}-${currentYear} data from Google Search
4. For news, fetch REAL recent articles published between ${sixMonthsAgoStr} and ${currentDateStr} ONLY - reject any older articles

JSON Format:
{
  "stateName": "${stateName}",
  "executiveSummary": {
    "overview": "<2-3 sentences about overall real estate landscape>",
    "politicalFactors": "<government policies, regulations, elections impact, housing schemes>",
    "economicFactors": "<GDP growth, employment, industries, investment climate>",
    "marketOutlook": "<future projections, opportunities, risks>"
  },
  "latestNews": [
    {
      "headline": "<news headline>",
      "date": "<DD MMM YYYY>",
      "summary": "<1-2 sentence summary>",
      "source": "<source name>"
    }
  ],
  "investmentScore": <number 1-100>,
  "summary": "<comprehensive 2-3 sentence market overview>",
  "topCities": [
    {
      "name": "<city name>",
      "tier": "Tier 1" | "Tier 2" | "Tier 3",
      "growthPotential": "High" | "Moderate" | "Stable",
      "avgPriceSqFt": "‚ÇπXXXX in <area type>",
      "description": "<investment rationale with specific factors>"
    }
  ],
  "fastestGrowingCities": [
    {
      "name": "<city name>",
      "growthRate": "<XX% YoY ${currentYear - 1}-${currentYear}>",
      "reason": "<why it's growing fast>"
    }
  ],
  "marketTrends": ["<specific trend with data/percentages>", "..."],
  "infrastructureProjects": ["<project name with timeline and impact>", "..."]
}

Return ONLY the JSON object, nothing else.`;
        const config = {
            tools: [
                {
                    googleSearch: {}
                }
            ]
        };
        const response = await ai.models.generateContent({
            model: "gemini-3-pro-preview",
            contents: prompt,
            config
        });
        const text = response.text;
        if (!text) {
            throw new Error("No response from AI");
        }
        // Enhanced JSON extraction - handles text before/after JSON and markdown blocks
        let jsonText = text.trim();
        // Remove all markdown code blocks (```json or ``` anywhere in the text)
        jsonText = jsonText.replace(/```json\n?/g, '').replace(/```\n?/g, '');
        // Find the actual JSON object by locating the first { and last }
        const firstBrace = jsonText.indexOf('{');
        const lastBrace = jsonText.lastIndexOf('}');
        if (firstBrace === -1 || lastBrace === -1 || firstBrace >= lastBrace) {
            console.error('‚ùå No valid JSON object found in response');
            console.error('Full response (first 500 chars):', text.substring(0, 500));
            throw new Error('AI returned invalid JSON format - no JSON object found');
        }
        // Extract just the JSON object
        jsonText = jsonText.substring(firstBrace, lastBrace + 1).trim();
        try {
            const data = JSON.parse(jsonText);
            // Validate and transform arrays to ensure they contain only strings
            if (data.marketTrends && Array.isArray(data.marketTrends)) {
                data.marketTrends = data.marketTrends.map((item)=>{
                    if (typeof item === 'string') return item;
                    if (typeof item === 'object' && item !== null) {
                        // If it's an object, concatenate its values
                        return Object.values(item).join(' - ');
                    }
                    return String(item);
                });
            }
            if (data.infrastructureProjects && Array.isArray(data.infrastructureProjects)) {
                data.infrastructureProjects = data.infrastructureProjects.map((item)=>{
                    if (typeof item === 'string') return item;
                    if (typeof item === 'object' && item !== null) {
                        // If it's an object, concatenate its values
                        return Object.values(item).join(' - ');
                    }
                    return String(item);
                });
            }
            console.log('‚úÖ Successfully parsed state analysis for:', stateName);
            return __TURBOPACK__imported__module__$5b$project$5d2f$Desktop$2f$2025$2f$EstateIQIndia$2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json(data);
        } catch (parseError) {
            console.error('‚ùå Failed to parse JSON');
            console.error('Extracted JSON (first 500 chars):', jsonText.substring(0, 500));
            console.error('Full AI response (first 500 chars):', text.substring(0, 500));
            console.error('Parse error:', parseError);
            throw new Error('AI returned invalid JSON format - parse failed');
        }
    } catch (error) {
        console.error("State Analysis Error:", error);
        return __TURBOPACK__imported__module__$5b$project$5d2f$Desktop$2f$2025$2f$EstateIQIndia$2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
            error: error.message || 'Failed to analyze state'
        }, {
            status: 500
        });
    }
}
}),
];

//# sourceMappingURL=%5Broot-of-the-server%5D__3c1fa5f7._.js.map